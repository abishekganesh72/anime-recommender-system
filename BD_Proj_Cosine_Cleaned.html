<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>BD_Proj_Cosine_Cleaned - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/img/favicon.ico"/>
<script>window.settings = {"enableUsageDeliveryConfiguration":false,"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableDynamicAutoCompleteResourceLoading":false,"enableClusterMetricsUI":true,"allowWhitelistedIframeDomains":true,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":true,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableWorkspaceBrowserSorting":true,"enableSentryLogging":true,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"dev-tier-node","spark_version":"4.0.x-scala2.11","num_workers":0,"aws_attributes":{"first_on_demand":0,"availability":"ON_DEMAND","zone_id":"us-west-2c","spot_bid_price_percent":100},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"abishek.ganesh@mavs.uta.edu","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableBitbucketCloud":true,"shouldShowCommandStatus":true,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db6-rc-scala2.10","displayName":"Spark 2.1.1-db6 RC (Scala 2.10)","packageLabel":"spark-image-275ef031d297859c0a1dcb73f2f41158d5b9584f6df2ed095e9ac2c9bba29d18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-rc-scala2.10","displayName":"3.0 RC (Scala 2.10)","packageLabel":"spark-image-c6236a100a712d97273f09a666e1792bc108b2b5250f7819e6569c01caa8e26a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-22756288786762d246bac1381e4f44610a4c2c3135c717c5ac3661822a723f1c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-rc-scala2.11","displayName":"Spark 2.1.1-db5 RC (Scala 2.11)","packageLabel":"spark-image-d68ceea32b5355dd71af516301e4bec8b0572ce7309eeb000ddd7426af274c92","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-7ce07ae16a775d917d6748d2075807565c157286f4f5957c1b77275b3b2a9bc4","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-86a9b375074f5afad339e70230ec0ec265c4cefbd280844785fab3bcde5869f9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-cdfb5c6299de6a2f4f5b75e8def2d11faa2026a8354185434873ec4612916663","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-4efc0c94e152791782f2cb865ac1eb3c11985a2671a77e6ef930f9718851459d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-ab147bdd6662fef83fa48e41d909aa045422585552758dc667f1971876c4486f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.5.x-rc-scala2.11","displayName":"3.5.3 RC (Scala 2.11)","packageLabel":"spark-image-272e0cdbeaa23cad80675e7c1dbbc559bb5be7582c45b43ab14522353e512d84","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-rc-scala2.11","displayName":"4.0 RC (Scala 2.11)","packageLabel":"spark-image-550001766b18e8b019812cf05bc92548f0fa650fba38932a53e0a205c1b1d284","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (GPU, Scala 2.11)","packageLabel":"spark-image-b543c0700f83413b0055359ea9feaf285f2e2f3350fb7f301ea0e18b018b5cb5","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-f91cb0b3822c6641a9d346ef6c149118fb859b5e511ee01c31e958892ba23c7a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-25dac86138b91b354c5882419df5c45cd3695fb36b3a14ad63ff459cd7ae28b8","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-e50cbe4c0b0ad46930872eff4b69665890fd6a170e2b1a3e48c1cdea5823fd86","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-gpu-scala2.11","displayName":"3.4.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-fc0879697a7f38da3a619999a88b9b54b361bd35cb39d4f291c906b942189188","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, GPU, Scala 2.11)","packageLabel":"spark-image-b543c0700f83413b0055359ea9feaf285f2e2f3350fb7f301ea0e18b018b5cb5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-rc-scala2.10","displayName":"Spark 2.1.1-db4 RC (Scala 2.10)","packageLabel":"spark-image-6ad0babd1477068b69f8cf2ffb443a36b6def104305a498b48bf9d2bb594af57","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-rc-scala2.10","displayName":"Spark 2.1.1-db5 RC (Scala 2.10)","packageLabel":"spark-image-14929a4472cc13e67ac05a086cb4a4db71b5066725b0cad78deff6359707d443","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-62365f2d91529bc1128d8968f33d07f5b8d75cf7305de9455bc970e6e1fecbb4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-8af050461b1b07f00c2a7e198d6781acb1cd7bf1899064047b37ef3f2b05c800","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.1-db6-rc-scala2.11","displayName":"Spark 2.1.1-db6 RC (Scala 2.11)","packageLabel":"spark-image-bd88d256e6da44bbc05d313f07e3148af3e7d1f9c90f008e4761cef7dffc9f16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-0adabd34980ecfcbc6a48ac5c9e3a954cf5ec3a53a3300ae0e392c03299d89ca","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.11","displayName":"3.3.3 RC (Scala 2.11)","packageLabel":"spark-image-5189d31b0d57e4ed7885c9c3b0d46fbc1c785fc275e5cfe00444b34e00a98a14","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-scala2.11","displayName":"3.4.3 RC (Scala 2.11)","packageLabel":"spark-image-158b332092e7d4d2f12cef325f42fbf399247e51508a5a1c5beb520ff4813ef8","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-rc-gpu-scala2.11","displayName":"3.3.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-7a60887a19765c53ca4750526e4124bcd65dfaa3ea43c5e97536b2698f64b247","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.1-db4-rc-scala2.11","displayName":"Spark 2.1.1-db4 RC (Scala 2.11)","packageLabel":"spark-image-eda763219642d144f69c10033b698c8dc77dff59242825ce15bd5041f3e4ee8f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-fe8300ae2b3bf12c79ce76d7e9d2d03995e58d1497cfb6c0d3172efb630cb2df","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"4.0.x-rc-gpu-scala2.11","displayName":"4.0 RC (GPU, Scala 2.11)","packageLabel":"spark-image-0101ba46f619bc121062962bd840c2158cabae8d3813ccb2f7e2f6d0156dcd15","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.10","displayName":"3.3.3 RC (Scala 2.10)","packageLabel":"spark-image-ae5bb08f7dbbdda9cc5554443e2ebfa4648120a6df00554fd7c20035037cad06","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-0112f566715b00d5aceb1b98543285bcb3a0f38174b86abd1c096c3e861043eb","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"[DEPRECATED] Latest stable (Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.10","displayName":"3.4.3 RC (Scala 2.10)","packageLabel":"spark-image-27dacad43a9b2c05d5aaf4b365744ec0bca519a93d08aeb7c7186d47cfdfdac4","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.1.x-rc-scala2.10","displayName":"3.1 RC (Scala 2.10)","packageLabel":"spark-image-c73d7c656d260f9e7c61c8c572efac5771112da87ae5f872725effb561a7a734","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-07da7d24ad964d7a43f53bd9feac55de7df890ef6e5f6bac8975fb7aa3e2a0a7","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-66d1366768039140a9f5409f3bab414cb7477ebd8d4bbf8b32cb885120f9f705","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-331830dacb000575ff0c9226e76ec1b2997a69f49da4eba399765d774fa0e676","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"3.2.x-rc-scala2.11","displayName":"3.2 RC (Scala 2.11)","packageLabel":"spark-image-fe6e822eae28683a119e212fc5541ef54cb2348b0637d66e117929df4aaab45b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-2fdca45e0fcac7081823a5faef4f25d6fc909d11c44eca82e1dd18e9d2ef2859","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-cdfb5c6299de6a2f4f5b75e8def2d11faa2026a8354185434873ec4612916663","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-0d3a99d46a4c55642850b5eba9aad3b56ffb9adbe8c8893403eba834399960fc","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-1f615934d3e248da8dcfb3e03bd8d92e933a17845fedb7cce12af2a0220ba6a2","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-rc-scala2.11","displayName":"3.0 RC (Scala 2.11)","packageLabel":"spark-image-a1866e4347f24a3db9a041dae20f1f1c7d836b38aa74a2099f47ff63472faee7","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.5.x-rc-gpu-scala2.11","displayName":"3.5.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-9158d808c11f3b39b1de8a3d39646a0581142e141f387a10ef18dc7b94ecf7dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-c6b477859faf291f56ac2dcbe6f6693d60e403c12dfcac58892b4014614363c3","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-46cc39a9afa43fbd7bfa9f4f5ed8d23f658cd0b0d74208627243222ae0d22f8d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-c8547fab0cc66b918f9a64c7e35532de209d0d0e06da6078ad787ec718b37e7b","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-0067951c626cad90625cce4d2dcf3e00a1029375f8e5470d2330036d0d3c505f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-b512ba976616af10269438701339a9bd5a97cc386737c6ecffdda5fb31c3cf20","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.1.x-rc-scala2.11","displayName":"3.1 RC (Scala 2.11)","packageLabel":"spark-image-949dc477b0ee7bc6086f59a8aefb60de8326492210c49790f8cef4da6440e87b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-8af050461b1b07f00c2a7e198d6781acb1cd7bf1899064047b37ef3f2b05c800","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-3b22b5c8d5577281bcca8dd6ef07553fb32b3b99ab977f8bdb7238f850ece887","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-2fdca45e0fcac7081823a5faef4f25d6fc909d11c44eca82e1dd18e9d2ef2859","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-0ea14d4a8a71de38872dd398b1139d55302680cfe3e9da217576c8304cd19b24","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-331830dacb000575ff0c9226e76ec1b2997a69f49da4eba399765d774fa0e676","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"3.5.x-rc-scala2.10","displayName":"3.5.3 RC (Scala 2.10)","packageLabel":"spark-image-d747df35392b5470586d9a614ac5f970aa1261242d92869f8d8934c567f09c2d","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-867d7300605c0c54b2b1394d1bba7b88b28ed5841b3575253cded34db6ce6454","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.2.x-rc-scala2.10","displayName":"3.2 RC (Scala 2.10)","packageLabel":"spark-image-6d4de0606aad0b9dc081996d682abaffba0388ee87911f906668254a66524a0d","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":false,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"Standard_E64s_v3":16,"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"Standard_D11_v2":0.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS4_v2_Promo":1.5,"Standard_DS14":4,"Standard_DS11_v2_Promo":0.5,"r4.16xlarge":16,"Standard_NC6":2,"Standard_DS11":0.5,"Standard_D2_v3":0.5,"Standard_DS14_v2_Promo":4,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_D13_v2":2,"Standard_DS13_v2_Promo":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_NC24":8,"Standard_NC24r":8,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"Standard_DS2_v2_Promo":0.5,"c3.8xlarge":4,"Standard_D4_v3":0.75,"Standard_E2s_v3":0.5,"Standard_D32_v3":6,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"Standard_DS3_v2_Promo":0.75,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_D14_v2":4,"Standard_H16":4,"Standard_NC12":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_D15_v2":5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"Standard_D12_v2":1,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_D16_v3":3,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS12_v2_Promo":1,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_DS5_v2_Promo":3,"Standard_D64_v3":12,"Standard_D2_v2":0.5,"Standard_D8_v3":1.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"Standard_D4_v2":1.5,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":false,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.69.54","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"enableNewLineChart":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"commandStatusDebounceMaxWait":1000,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableExperimentalCharts":false,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":false,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"enableNewLineChartParams":false,"deprecatedEnableStructuredDataAcls":false,"enableCustomSpotPricing":false,"enableRStudioFreeUI":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":true,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","commandStatusDebounceInterval":100,"showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":true,"enableSparkConfUI":true,"enableClusterEventsUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python,r"},"aws_attributes":{"ebs_volume_count":null,"availability":"ON_DEMAND","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2c","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":false,"default_tags":{"Vendor":"Databricks","Creator":"abishek.ganesh@mavs.uta.edu","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":true,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":false,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":true,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableRServerless":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true","spark.databricks.repl.allowedLanguages":"python,sql"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enablePythonVersionUI":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":false,"enableMiniClusters":true,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":false,"enableUserPromptForPendingRpc":true,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":false,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":1634643082207786,"name":"BD_Proj_Cosine_Cleaned","language":"python","commands":[{"version":"CommandV1","origId":1634643082207787,"guid":"89beb525-7ab1-49ba-9409-ab61d22bb625","subtype":"command","commandType":"auto","position":1.0,"command":"ratings= sqlContext.read.csv('/FileStore/tables/qthksaj91493514788924/rating_cleaned.csv', sep=',' , inferSchema=True, header=True)\nanime = sqlContext.read.csv('/FileStore/tables/ezjvoa7k1493514682679/anime_clean.tsv', sep='\\t', inferSchema=True, header=True)\nnames= sqlContext.read.csv('/FileStore/tables/p4kjul861493612915497/anime_name.csv', inferSchema=True, header=True)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"ratings","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"user_id","nullable":true,"type":"integer"},{"metadata":{},"name":"anime_id","nullable":true,"type":"integer"},{"metadata":{},"name":"rating","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"anime","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"anime_id","nullable":true,"type":"integer"},{"metadata":{},"name":"genre","nullable":true,"type":"string"},{"metadata":{},"name":"type","nullable":true,"type":"string"},{"metadata":{},"name":"episodes","nullable":true,"type":"integer"},{"metadata":{},"name":"rating","nullable":true,"type":"double"},{"metadata":{},"name":"members","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"names","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"anime_id","nullable":true,"type":"integer"},{"metadata":{},"name":"name","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929322185,"submitTime":1519929319637,"finishTime":1519929336000,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Inputs ","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5a12a939-320c-410b-8974-7c4aabc1f8dc"},{"version":"CommandV1","origId":1634643082207788,"guid":"02300413-b0fc-4549-9dad-795aefcbc531","subtype":"command","commandType":"auto","position":2.0,"command":"animes = spark.createDataFrame(anime.rdd.map(lambda x: (x[0], x[1].lower().replace('\"',\"\").replace(' ',\"\").split(','))), ['anime_id','genre'])\nprint animes.show(2)\nprint anime.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------+--------------------+\n|anime_id|               genre|\n+--------+--------------------+\n|   32281|[drama, romance, ...|\n|    5114|[action, adventur...|\n+--------+--------------------+\nonly showing top 2 rows\n\nNone\n11830\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"animes","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"anime_id","nullable":true,"type":"long"},{"metadata":{},"name":"genre","nullable":true,"type":{"containsNull":true,"elementType":"string","type":"array"}}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929336014,"submitTime":1519929319729,"finishTime":1519929341782,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Clean the data ","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d3493c15-e4c2-4c98-87ce-ba1f618e95b5"},{"version":"CommandV1","origId":1634643082207789,"guid":"0062793d-d131-4186-91a9-4d541e0e78e9","subtype":"command","commandType":"auto","position":2.5,"command":"count  = []\nfor i in animes.collect():\n  count.extend(i[1])\nprint len(count), len(set(count))\ncount_genre = len(set(count))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">35201 43\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929341792,"submitTime":1519929319834,"finishTime":1519929343449,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Find Count of unique Genre","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"79477602-d025-436f-9f78-5bb5298d6f7d"},{"version":"CommandV1","origId":1634643082207790,"guid":"8c9fa979-6a4e-4971-b859-20bdf7a09690","subtype":"command","commandType":"auto","position":3.0,"command":"from pyspark.ml.feature import CountVectorizer\nfrom pyspark.ml.linalg import Vectors","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929343464,"submitTime":1519929319937,"finishTime":1519929343559,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e52036e2-3519-4d9d-b701-ec9d0eaca42f"},{"version":"CommandV1","origId":1634643082207791,"guid":"1af8fefa-faf3-46b8-a814-d98f5eb7339b","subtype":"command","commandType":"auto","position":4.0,"command":"cv = CountVectorizer(inputCol=\"genre\", outputCol=\"features\", vocabSize=count_genre, minDF=2.0)\ncvmodel = cv.fit(animes)\nanimes_transformed = cvmodel.transform(animes)\nanimes_transformed.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">5</span><span class=\"ansired\">]: </span>\n[Row(anime_id=32281, genre=[u&apos;drama&apos;, u&apos;romance&apos;, u&apos;school&apos;, u&apos;supernatural&apos;], features=SparseVector(43, {5: 1.0, 8: 1.0, 10: 1.0, 12: 1.0})),\n Row(anime_id=5114, genre=[u&apos;action&apos;, u&apos;adventure&apos;, u&apos;drama&apos;, u&apos;fantasy&apos;, u&apos;magic&apos;, u&apos;military&apos;, u&apos;shounen&apos;], features=SparseVector(43, {1: 1.0, 2: 1.0, 3: 1.0, 5: 1.0, 6: 1.0, 16: 1.0, 23: 1.0})),\n Row(anime_id=28977, genre=[u&apos;action&apos;, u&apos;comedy&apos;, u&apos;historical&apos;, u&apos;parody&apos;, u&apos;samurai&apos;, u&apos;sci-fi&apos;, u&apos;shounen&apos;], features=SparseVector(43, {0: 1.0, 1: 1.0, 4: 1.0, 6: 1.0, 15: 1.0, 24: 1.0, 34: 1.0})),\n Row(anime_id=9253, genre=[u&apos;sci-fi&apos;, u&apos;thriller&apos;], features=SparseVector(43, {4: 1.0, 36: 1.0})),\n Row(anime_id=9969, genre=[u&apos;action&apos;, u&apos;comedy&apos;, u&apos;historical&apos;, u&apos;parody&apos;, u&apos;samurai&apos;, u&apos;sci-fi&apos;, u&apos;shounen&apos;], features=SparseVector(43, {0: 1.0, 1: 1.0, 4: 1.0, 6: 1.0, 15: 1.0, 24: 1.0, 34: 1.0}))]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"animes_transformed","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"anime_id","nullable":true,"type":"long"},{"metadata":{},"name":"genre","nullable":true,"type":{"containsNull":true,"elementType":"string","type":"array"}},{"metadata":{},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;CountVectorizer&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-1634643082207791&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>cv <span class=\"ansiyellow\">=</span> CountVectorizer<span class=\"ansiyellow\">(</span>inputCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;genre&quot;</span><span class=\"ansiyellow\">,</span> outputCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;features&quot;</span><span class=\"ansiyellow\">,</span> vocabSize<span class=\"ansiyellow\">=</span>count_genre<span class=\"ansiyellow\">,</span> minDF<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2.0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> cvmodel <span class=\"ansiyellow\">=</span> cv<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>animes<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> animes_transformed <span class=\"ansiyellow\">=</span> cvmodel<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>animes<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> animes_transformed<span class=\"ansiyellow\">.</span>take<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;CountVectorizer&apos; is not defined</div>","workflows":[],"startTime":1519929343571,"submitTime":1519929320042,"finishTime":1519929347031,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Vectorize the data, fit the data","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a3315471-82d9-493e-b9ae-745cbc0fc2f8"},{"version":"CommandV1","origId":1634643082207793,"guid":"c20746f1-aa04-4663-b911-c865b3e35659","subtype":"command","commandType":"auto","position":6.0,"command":"fnldata = spark.createDataFrame(animes_transformed.select('anime_id', 'features').rdd.map(lambda x: (x[0], Vectors.dense(x[1]))), ['id', 'DenseVector'])\nprint fnldata.take(5)\nprint fnldata.show(5)\nfnldata.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[Row(id=32281, DenseVector=DenseVector([0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])), Row(id=5114, DenseVector=DenseVector([0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])), Row(id=28977, DenseVector=DenseVector([1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])), Row(id=9253, DenseVector=DenseVector([0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])), Row(id=9969, DenseVector=DenseVector([1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]))]\n+-----+--------------------+\n|   id|         DenseVector|\n+-----+--------------------+\n|32281|[0.0,0.0,0.0,0.0,...|\n| 5114|[0.0,1.0,1.0,1.0,...|\n|28977|[1.0,1.0,0.0,0.0,...|\n| 9253|[0.0,0.0,0.0,0.0,...|\n| 9969|[1.0,1.0,0.0,0.0,...|\n+-----+--------------------+\nonly showing top 5 rows\n\nNone\n<span class=\"ansired\">Out[</span><span class=\"ansired\">6</span><span class=\"ansired\">]: </span>DataFrame[id: bigint, DenseVector: vector]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"fnldata","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"DenseVector","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929347041,"submitTime":1519929320144,"finishTime":1519929380838,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":" Convert Sparse Vector to Dense","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5c77cf9a-5a06-49f4-93e8-92a2b8309904"},{"version":"CommandV1","origId":1634643082207794,"guid":"de2ff5a7-7de2-4524-b3f8-6bcc2344fd7b","subtype":"command","commandType":"auto","position":7.0,"command":"# Get distance functions from Sklearn\nfrom sklearn.metrics.pairwise import cosine_similarity\nfrom sklearn.metrics import jaccard_similarity_score\nfrom sklearn.metrics.pairwise import euclidean_distances\nfrom sklearn.metrics.pairwise import manhattan_distances\nfrom pprint import pprint\nimport pandas as pd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929380892,"submitTime":1519929320247,"finishTime":1519929381599,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f98af5da-9ec2-449d-91ce-254c8ba9bd4d"},{"version":"CommandV1","origId":1634643082207795,"guid":"181d1539-d07c-4ce6-812e-9752a3ab672f","subtype":"command","commandType":"auto","position":8.0,"command":"test_id = 22043\ntest_vector= fnldata.rdd.lookup(test_id)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;fnldata&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-1634643082207795&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> test_id <span class=\"ansiyellow\">=</span> <span class=\"ansicyan\">22043</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>test_vector<span class=\"ansiyellow\">=</span> fnldata<span class=\"ansiyellow\">.</span>rdd<span class=\"ansiyellow\">.</span>lookup<span class=\"ansiyellow\">(</span>test_id<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;fnldata&apos; is not defined</div>","workflows":[],"startTime":1519929381612,"submitTime":1519929320379,"finishTime":1519929400405,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Test the recommendations for a test users","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f4d798da-4b1f-4a1b-b1b4-8e427c3d0f17"},{"version":"CommandV1","origId":1634643082207796,"guid":"302ee91f-5dbf-491d-bb16-704fb9486913","subtype":"command","commandType":"auto","position":9.0,"command":"cosine_dist =spark.createDataFrame(fnldata.rdd.map(lambda x: (x[0], float(cosine_similarity(x[1], test_vector)[0][0]))), ['anime_id', 'cosine_sim'])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"cosine_dist","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"anime_id","nullable":true,"type":"long"},{"metadata":{},"name":"cosine_sim","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929400409,"submitTime":1519929320479,"finishTime":1519929400786,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Calculate Cosine Similarity between the test id and rdd elements","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"55dc2e03-cc74-4fe7-981c-75bf9b8f41e7"},{"version":"CommandV1","origId":1634643082207797,"guid":"cd17e01b-411f-4572-8158-eddd1b486327","subtype":"command","commandType":"auto","position":10.0,"command":"cosine_recomm=cosine_dist.join(names, names.anime_id==cosine_dist.anime_id).sort('cosine_sim',ascending=False).take(26)\nprint pd.DataFrame(cosine_recomm).head(26)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">        0         1      2                                                  3\n0   22043  1.000000  22043                                  Fairy Tail (2014)\n1   18393  1.000000  18393                                  Fairy Tail x Rave\n2    6702  1.000000   6702                                         Fairy Tail\n3   12049  1.000000  12049                  Fairy Tail Movie 1: Houou no Miko\n4   11385  0.912871  11385  Digimon Xros Wars: Toki wo Kakeru Shounen Hunt...\n5   22097  0.912871  22097                             Magi: Sinbad no Bouken\n6   18115  0.912871  18115                         Magi: The Kingdom of Magic\n7    8086  0.912871   8086                     Densetsu no Yuusha no Densetsu\n8   10033  0.912871  10033                                             Toriko\n9    2472  0.912871   2472                         Naruto: Shippuuden Movie 1\n10  31741  0.912871  31741                        Magi: Sinbad no Bouken (TV)\n11   9999  0.912871   9999                       One Piece 3D: Mugiwara Chase\n12  24261  0.912871  24261                              Hitsugi no Chaika OVA\n13  21235  0.912871  21235                                  Log Horizon Recap\n14  14513  0.912871  14513                       Magi: The Labyrinth of Magic\n15   9690  0.912871   9690        Densetsu no Yuusha no Densetsu: Iris Report\n16  10444  0.912871  10444  Digimon Xros Wars: Aku no Death General to Nan...\n17    738  0.912871    738                                                MR\n18   7364  0.912871   7364  Dragon Quest: Dai no Daibouken Buchiyabure!! S...\n19  12001  0.912871  12001                One Piece 3D: Gekisou! Trap Coaster\n20   8624  0.912871   8624                                  Digimon Xros Wars\n21   7436  0.912871   7436  Dragon Quest: Dai no Daibouken Tachiagare!! Ab...\n22   1181  0.912871   1181                     Hikyou Tanken Fam &amp;amp; Ihrlie\n23   2606  0.912871   2606  Digimon Savers the Movie: Kyuukyoku Power! Bur...\n24  25431  0.912871  25431                   Chain Chronicle: Short Animation\n25   2782  0.912871   2782                                        Fire Emblem\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929400793,"submitTime":1519929320582,"finishTime":1519929411638,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Take 25 of the top recommendation","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c1144143-4adc-45ad-a7d5-9bf6e2ae7019"},{"version":"CommandV1","origId":1634643082207798,"guid":"cbaa4295-0aed-4fd0-bdbd-5c5c33e3e8a6","subtype":"command","commandType":"auto","position":11.0,"command":"#Calculate Cosine Similarity between the test id and rdd elements\neuclidean_dist =spark.createDataFrame(fnldata.rdd.map(lambda x: (x[0], float( euclidean_distances(x[1], test_vector)[0][0]))), ['anime_id', 'euclidean_distances'])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"euclidean_dist","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"anime_id","nullable":true,"type":"long"},{"metadata":{},"name":"euclidean_distances","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929411650,"submitTime":1519929320685,"finishTime":1519929412109,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3544d577-4b91-4715-92dc-065896989f69"},{"version":"CommandV1","origId":1634643082207799,"guid":"fac85731-9e9a-4196-8063-e827db19ff2c","subtype":"command","commandType":"auto","position":12.0,"command":"# take 26 of the values for recommendation\neuclidean_recomm=euclidean_dist.join(names, names.anime_id==euclidean_dist.anime_id).sort('euclidean_distances',ascending=True).take(26)\n#pprint(euclidean_recomm)\npd.DataFrame(euclidean_recomm).head(25)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">12</span><span class=\"ansired\">]: </span>\n        0    1      2                                                  3\n0   18393  0.0  18393                                  Fairy Tail x Rave\n1   22043  0.0  22043                                  Fairy Tail (2014)\n2    6702  0.0   6702                                         Fairy Tail\n3   12049  0.0  12049                  Fairy Tail Movie 1: Houou no Miko\n4     332  1.0    332              Dokidoki Densetsu: Mahoujin Guru Guru\n5   22097  1.0  22097                             Magi: Sinbad no Bouken\n6   31741  1.0  31741                        Magi: Sinbad no Bouken (TV)\n7     869  1.0    869                                     Slayers Return\n8     331  1.0    331                                 Mahoujin Guru Guru\n9   14513  1.0  14513                       Magi: The Labyrinth of Magic\n10    738  1.0    738                                                MR\n11   1018  1.0   1018                         Majutsushi Orphen: Revenge\n12  21235  1.0  21235                                  Log Horizon Recap\n13   7436  1.0   7436  Dragon Quest: Dai no Daibouken Tachiagare!! Ab...\n14    868  1.0    868                                      Slayers Great\n15   2606  1.0   2606  Digimon Savers the Movie: Kyuukyoku Power! Bur...\n16    536  1.0    536                        Slayers: The Motion Picture\n17   8624  1.0   8624                                  Digimon Xros Wars\n18   1855  1.0   1855                                  JaJa Uma! Quartet\n19  10444  1.0  10444  Digimon Xros Wars: Aku no Death General to Nan...\n20   8086  1.0   8086                     Densetsu no Yuusha no Densetsu\n21  18115  1.0  18115                         Magi: The Kingdom of Magic\n22   1181  1.0   1181                     Hikyou Tanken Fam &amp;amp; Ihrlie\n23  12001  1.0  12001                One Piece 3D: Gekisou! Trap Coaster\n24   1164  1.0   1164                                 Mahou Senshi Louie\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929412121,"submitTime":1519929320814,"finishTime":1519929421643,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8db461ce-bf96-4a96-94c0-d57d887a1cdf"},{"version":"CommandV1","origId":1634643082207800,"guid":"c6b784e6-4bc3-48ee-be56-00ea4cc2bbf6","subtype":"command","commandType":"auto","position":13.0,"command":"#Calculate Manhattan Dist between the test id and rdd elements\nmanhattan_dist =spark.createDataFrame(fnldata.rdd.map(lambda x: (x[0], float( manhattan_distances(x[1], test_vector)[0][0]))), ['anime_id', 'manhattan_distances'])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"manhattan_dist","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"anime_id","nullable":true,"type":"long"},{"metadata":{},"name":"manhattan_distances","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929421652,"submitTime":1519929320941,"finishTime":1519929422285,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc146f27-3de7-400d-a538-e76a77bf55a0"},{"version":"CommandV1","origId":1634643082207801,"guid":"4d468ecd-b28d-4f3d-abf4-192915a0be12","subtype":"command","commandType":"auto","position":14.0,"command":"# take 26 of the values for recommendation\nmanhattan_recomm=manhattan_dist.join(names, names.anime_id==manhattan_dist.anime_id).sort('manhattan_distances',ascending=True).take(26)\n#pprint(manhattan_recomm)\npd.DataFrame(manhattan_recomm).head(26)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">14</span><span class=\"ansired\">]: </span>\n        0    1      2                                                  3\n0   18393  0.0  18393                                  Fairy Tail x Rave\n1   22043  0.0  22043                                  Fairy Tail (2014)\n2    6702  0.0   6702                                         Fairy Tail\n3   12049  0.0  12049                  Fairy Tail Movie 1: Houou no Miko\n4     332  1.0    332              Dokidoki Densetsu: Mahoujin Guru Guru\n5   22097  1.0  22097                             Magi: Sinbad no Bouken\n6   31741  1.0  31741                        Magi: Sinbad no Bouken (TV)\n7     869  1.0    869                                     Slayers Return\n8     331  1.0    331                                 Mahoujin Guru Guru\n9   14513  1.0  14513                       Magi: The Labyrinth of Magic\n10    738  1.0    738                                                MR\n11   1018  1.0   1018                         Majutsushi Orphen: Revenge\n12  21235  1.0  21235                                  Log Horizon Recap\n13   7436  1.0   7436  Dragon Quest: Dai no Daibouken Tachiagare!! Ab...\n14    868  1.0    868                                      Slayers Great\n15   2606  1.0   2606  Digimon Savers the Movie: Kyuukyoku Power! Bur...\n16    536  1.0    536                        Slayers: The Motion Picture\n17   8624  1.0   8624                                  Digimon Xros Wars\n18   1855  1.0   1855                                  JaJa Uma! Quartet\n19  10444  1.0  10444  Digimon Xros Wars: Aku no Death General to Nan...\n20   8086  1.0   8086                     Densetsu no Yuusha no Densetsu\n21  18115  1.0  18115                         Magi: The Kingdom of Magic\n22   1181  1.0   1181                     Hikyou Tanken Fam &amp;amp; Ihrlie\n23  12001  1.0  12001                One Piece 3D: Gekisou! Trap Coaster\n24   1164  1.0   1164                                 Mahou Senshi Louie\n25   7364  1.0   7364  Dragon Quest: Dai no Daibouken Buchiyabure!! S...\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929422293,"submitTime":1519929321073,"finishTime":1519929432390,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2fece9ba-437d-442f-865d-4a9e03295b76"},{"version":"CommandV1","origId":1634643082207802,"guid":"98e5b620-53a8-40a2-82d7-86e5d99339c5","subtype":"command","commandType":"auto","position":15.0,"command":"jaccard_sim =spark.createDataFrame(fnldata.rdd.map(lambda x: (x[0], float(jaccard_similarity_score( test_vector[0], x[1])))), ['anime_id', 'jaccard_similarity'])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"jaccard_sim","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"anime_id","nullable":true,"type":"long"},{"metadata":{},"name":"jaccard_similarity","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929432400,"submitTime":1519929321188,"finishTime":1519929432829,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Calculate Jaccard Similarity between the test id and rdd elements","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8e400160-2503-4cda-9d7f-15ec9a282f2f"},{"version":"CommandV1","origId":1634643082207803,"guid":"ab1d462f-6e5f-4258-96a2-3d2b1d22e4d7","subtype":"command","commandType":"auto","position":16.0,"command":"# take 26 of the values for recommendation\njaccard_recomm=jaccard_sim.join(names, names.anime_id==jaccard_sim.anime_id).sort('jaccard_similarity',ascending=False).take(26)\n#pprint(jaccard_recomm)\npd.DataFrame(jaccard_recomm).head(25)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">16</span><span class=\"ansired\">]: </span>\n        0         1      2                                                  3\n0   18393  1.000000  18393                                  Fairy Tail x Rave\n1   22043  1.000000  22043                                  Fairy Tail (2014)\n2    6702  1.000000   6702                                         Fairy Tail\n3   12049  1.000000  12049                  Fairy Tail Movie 1: Houou no Miko\n4     332  0.976744    332              Dokidoki Densetsu: Mahoujin Guru Guru\n5   22097  0.976744  22097                             Magi: Sinbad no Bouken\n6   31741  0.976744  31741                        Magi: Sinbad no Bouken (TV)\n7     869  0.976744    869                                     Slayers Return\n8     331  0.976744    331                                 Mahoujin Guru Guru\n9   14513  0.976744  14513                       Magi: The Labyrinth of Magic\n10    738  0.976744    738                                                MR\n11   1018  0.976744   1018                         Majutsushi Orphen: Revenge\n12  21235  0.976744  21235                                  Log Horizon Recap\n13   7436  0.976744   7436  Dragon Quest: Dai no Daibouken Tachiagare!! Ab...\n14    868  0.976744    868                                      Slayers Great\n15   2606  0.976744   2606  Digimon Savers the Movie: Kyuukyoku Power! Bur...\n16    536  0.976744    536                        Slayers: The Motion Picture\n17   8624  0.976744   8624                                  Digimon Xros Wars\n18   1855  0.976744   1855                                  JaJa Uma! Quartet\n19  10444  0.976744  10444  Digimon Xros Wars: Aku no Death General to Nan...\n20   8086  0.976744   8086                     Densetsu no Yuusha no Densetsu\n21  18115  0.976744  18115                         Magi: The Kingdom of Magic\n22   1181  0.976744   1181                     Hikyou Tanken Fam &amp;amp; Ihrlie\n23  12001  0.976744  12001                One Piece 3D: Gekisou! Trap Coaster\n24   1164  0.976744   1164                                 Mahou Senshi Louie\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929432838,"submitTime":1519929321292,"finishTime":1519929442472,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"35ad6c34-f00f-4e71-9b3a-e566d8272f7f"},{"version":"CommandV1","origId":1634643082207804,"guid":"5611b637-1083-4440-8639-966b9656d005","subtype":"command","commandType":"auto","position":18.0,"command":"#print the recommedations\nprint \"Cosine , Euclidean, Manhattan, Jaccard\"\nfnl_recomm=[]\nfor i in range(len(cosine_recomm)) :\n  print (cosine_recomm[i][3],  euclidean_recomm[i][3], manhattan_recomm[i][3], jaccard_recomm[i][3])\n  fnl_recomm.append(cosine_recomm[i][3])\n  fnl_recomm.append(euclidean_recomm[i][3])\n  fnl_recomm.append(manhattan_recomm[i][3])\n  fnl_recomm.append(jaccard_recomm[i][3])\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Cosine , Euclidean, Manhattan, Jaccard\n(u&apos;Fairy Tail (2014)&apos;, u&apos;Fairy Tail x Rave&apos;, u&apos;Fairy Tail x Rave&apos;, u&apos;Fairy Tail x Rave&apos;)\n(u&apos;Fairy Tail x Rave&apos;, u&apos;Fairy Tail (2014)&apos;, u&apos;Fairy Tail (2014)&apos;, u&apos;Fairy Tail (2014)&apos;)\n(u&apos;Fairy Tail&apos;, u&apos;Fairy Tail&apos;, u&apos;Fairy Tail&apos;, u&apos;Fairy Tail&apos;)\n(u&apos;Fairy Tail Movie 1: Houou no Miko&apos;, u&apos;Fairy Tail Movie 1: Houou no Miko&apos;, u&apos;Fairy Tail Movie 1: Houou no Miko&apos;, u&apos;Fairy Tail Movie 1: Houou no Miko&apos;)\n(u&apos;Digimon Xros Wars: Toki wo Kakeru Shounen Hunter-tachi&apos;, u&apos;Dokidoki Densetsu: Mahoujin Guru Guru&apos;, u&apos;Dokidoki Densetsu: Mahoujin Guru Guru&apos;, u&apos;Dokidoki Densetsu: Mahoujin Guru Guru&apos;)\n(u&apos;Magi: Sinbad no Bouken&apos;, u&apos;Magi: Sinbad no Bouken&apos;, u&apos;Magi: Sinbad no Bouken&apos;, u&apos;Magi: Sinbad no Bouken&apos;)\n(u&apos;Magi: The Kingdom of Magic&apos;, u&apos;Magi: Sinbad no Bouken (TV)&apos;, u&apos;Magi: Sinbad no Bouken (TV)&apos;, u&apos;Magi: Sinbad no Bouken (TV)&apos;)\n(u&apos;Densetsu no Yuusha no Densetsu&apos;, u&apos;Slayers Return&apos;, u&apos;Slayers Return&apos;, u&apos;Slayers Return&apos;)\n(u&apos;Toriko&apos;, u&apos;Mahoujin Guru Guru&apos;, u&apos;Mahoujin Guru Guru&apos;, u&apos;Mahoujin Guru Guru&apos;)\n(u&apos;Naruto: Shippuuden Movie 1&apos;, u&apos;Magi: The Labyrinth of Magic&apos;, u&apos;Magi: The Labyrinth of Magic&apos;, u&apos;Magi: The Labyrinth of Magic&apos;)\n(u&apos;Magi: Sinbad no Bouken (TV)&apos;, u&apos;M\\xc4R&apos;, u&apos;M\\xc4R&apos;, u&apos;M\\xc4R&apos;)\n(u&apos;One Piece 3D: Mugiwara Chase&apos;, u&apos;Majutsushi Orphen: Revenge&apos;, u&apos;Majutsushi Orphen: Revenge&apos;, u&apos;Majutsushi Orphen: Revenge&apos;)\n(u&apos;Hitsugi no Chaika OVA&apos;, u&apos;Log Horizon Recap&apos;, u&apos;Log Horizon Recap&apos;, u&apos;Log Horizon Recap&apos;)\n(u&apos;Log Horizon Recap&apos;, u&apos;Dragon Quest: Dai no Daibouken Tachiagare!! Aban no Shito&apos;, u&apos;Dragon Quest: Dai no Daibouken Tachiagare!! Aban no Shito&apos;, u&apos;Dragon Quest: Dai no Daibouken Tachiagare!! Aban no Shito&apos;)\n(u&apos;Magi: The Labyrinth of Magic&apos;, u&apos;Slayers Great&apos;, u&apos;Slayers Great&apos;, u&apos;Slayers Great&apos;)\n(u&apos;Densetsu no Yuusha no Densetsu: Iris Report&apos;, u&apos;Digimon Savers the Movie: Kyuukyoku Power! Burst Mode Hatsudou!!&apos;, u&apos;Digimon Savers the Movie: Kyuukyoku Power! Burst Mode Hatsudou!!&apos;, u&apos;Digimon Savers the Movie: Kyuukyoku Power! Burst Mode Hatsudou!!&apos;)\n(u&apos;Digimon Xros Wars: Aku no Death General to Nanatsu no Oukoku&apos;, u&apos;Slayers: The Motion Picture&apos;, u&apos;Slayers: The Motion Picture&apos;, u&apos;Slayers: The Motion Picture&apos;)\n(u&apos;M\\xc4R&apos;, u&apos;Digimon Xros Wars&apos;, u&apos;Digimon Xros Wars&apos;, u&apos;Digimon Xros Wars&apos;)\n(u&apos;Dragon Quest: Dai no Daibouken Buchiyabure!! Shinsei 6 Daishougun&apos;, u&apos;JaJa Uma! Quartet&apos;, u&apos;JaJa Uma! Quartet&apos;, u&apos;JaJa Uma! Quartet&apos;)\n(u&apos;One Piece 3D: Gekisou! Trap Coaster&apos;, u&apos;Digimon Xros Wars: Aku no Death General to Nanatsu no Oukoku&apos;, u&apos;Digimon Xros Wars: Aku no Death General to Nanatsu no Oukoku&apos;, u&apos;Digimon Xros Wars: Aku no Death General to Nanatsu no Oukoku&apos;)\n(u&apos;Digimon Xros Wars&apos;, u&apos;Densetsu no Yuusha no Densetsu&apos;, u&apos;Densetsu no Yuusha no Densetsu&apos;, u&apos;Densetsu no Yuusha no Densetsu&apos;)\n(u&apos;Dragon Quest: Dai no Daibouken Tachiagare!! Aban no Shito&apos;, u&apos;Magi: The Kingdom of Magic&apos;, u&apos;Magi: The Kingdom of Magic&apos;, u&apos;Magi: The Kingdom of Magic&apos;)\n(u&apos;Hikyou Tanken Fam &amp;amp; Ihrlie&apos;, u&apos;Hikyou Tanken Fam &amp;amp; Ihrlie&apos;, u&apos;Hikyou Tanken Fam &amp;amp; Ihrlie&apos;, u&apos;Hikyou Tanken Fam &amp;amp; Ihrlie&apos;)\n(u&apos;Digimon Savers the Movie: Kyuukyoku Power! Burst Mode Hatsudou!!&apos;, u&apos;One Piece 3D: Gekisou! Trap Coaster&apos;, u&apos;One Piece 3D: Gekisou! Trap Coaster&apos;, u&apos;One Piece 3D: Gekisou! Trap Coaster&apos;)\n(u&apos;Chain Chronicle: Short Animation&apos;, u&apos;Mahou Senshi Louie&apos;, u&apos;Mahou Senshi Louie&apos;, u&apos;Mahou Senshi Louie&apos;)\n(u&apos;Fire Emblem&apos;, u&apos;Dragon Quest: Dai no Daibouken Buchiyabure!! Shinsei 6 Daishougun&apos;, u&apos;Dragon Quest: Dai no Daibouken Buchiyabure!! Shinsei 6 Daishougun&apos;, u&apos;Dragon Quest: Dai no Daibouken Buchiyabure!! Shinsei 6 Daishougun&apos;)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929442482,"submitTime":1519929321397,"finishTime":1519929442612,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"19f41e15-d582-44ca-bd50-620a30a8b079"},{"version":"CommandV1","origId":1634643082207805,"guid":"d04ba1e6-3cdc-4f48-b8fd-7b59e7879fd3","subtype":"command","commandType":"auto","position":19.0,"command":"print len(fnl_recomm), len(set(fnl_recomm))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">104 34\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929442618,"submitTime":1519929321499,"finishTime":1519929442646,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"32c98db0-29d3-4aba-9648-946f408255cf"},{"version":"CommandV1","origId":1634643082207806,"guid":"8745b3a5-b293-44ea-b6f3-37c2b30a55e5","subtype":"command","commandType":"auto","position":20.0,"command":"pprint (set(fnl_recomm))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">set([u&apos;Chain Chronicle: Short Animation&apos;,\n     u&apos;Densetsu no Yuusha no Densetsu&apos;,\n     u&apos;Densetsu no Yuusha no Densetsu: Iris Report&apos;,\n     u&apos;Digimon Savers the Movie: Kyuukyoku Power! Burst Mode Hatsudou!!&apos;,\n     u&apos;Digimon Xros Wars&apos;,\n     u&apos;Digimon Xros Wars: Aku no Death General to Nanatsu no Oukoku&apos;,\n     u&apos;Digimon Xros Wars: Toki wo Kakeru Shounen Hunter-tachi&apos;,\n     u&apos;Dokidoki Densetsu: Mahoujin Guru Guru&apos;,\n     u&apos;Dragon Quest: Dai no Daibouken Buchiyabure!! Shinsei 6 Daishougun&apos;,\n     u&apos;Dragon Quest: Dai no Daibouken Tachiagare!! Aban no Shito&apos;,\n     u&apos;Fairy Tail&apos;,\n     u&apos;Fairy Tail (2014)&apos;,\n     u&apos;Fairy Tail Movie 1: Houou no Miko&apos;,\n     u&apos;Fairy Tail x Rave&apos;,\n     u&apos;Fire Emblem&apos;,\n     u&apos;Hikyou Tanken Fam &amp;amp; Ihrlie&apos;,\n     u&apos;Hitsugi no Chaika OVA&apos;,\n     u&apos;JaJa Uma! Quartet&apos;,\n     u&apos;Log Horizon Recap&apos;,\n     u&apos;Magi: Sinbad no Bouken&apos;,\n     u&apos;Magi: Sinbad no Bouken (TV)&apos;,\n     u&apos;Magi: The Kingdom of Magic&apos;,\n     u&apos;Magi: The Labyrinth of Magic&apos;,\n     u&apos;Mahou Senshi Louie&apos;,\n     u&apos;Mahoujin Guru Guru&apos;,\n     u&apos;Majutsushi Orphen: Revenge&apos;,\n     u&apos;M\\xc4R&apos;,\n     u&apos;Naruto: Shippuuden Movie 1&apos;,\n     u&apos;One Piece 3D: Gekisou! Trap Coaster&apos;,\n     u&apos;One Piece 3D: Mugiwara Chase&apos;,\n     u&apos;Slayers Great&apos;,\n     u&apos;Slayers Return&apos;,\n     u&apos;Slayers: The Motion Picture&apos;,\n     u&apos;Toriko&apos;])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1519929442655,"submitTime":1519929321602,"finishTime":1519929442690,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f0dbd6f4-5708-4941-8950-f6827aba5b51"},{"version":"CommandV1","origId":1634643082207807,"guid":"e24dfa3c-b13a-456d-87e1-3d01bd43b31e","subtype":"command","commandType":"auto","position":21.0,"command":"fnldata.rdd.cartesian(fnldata.rdd).map(lambda (x, y):(x[0], y[0], cosine_similarity(x[1], y[1]))).take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">20</span><span class=\"ansired\">]: </span>\n[(32281, 32281, array([[ 1.]])),\n (32281, 5114, array([[ 0.18898224]])),\n (32281, 28977, array([[ 0.]])),\n (32281, 9253, array([[ 0.]])),\n (32281, 9969, array([[ 0.]]))]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1519929442701,"submitTime":1519929321703,"finishTime":1519929442981,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bd43a234-9f1d-479c-937e-e1b550c74c98"},{"version":"CommandV1","origId":1634643082207808,"guid":"2071cb26-1af0-435c-922e-0892b429a9a6","subtype":"command","commandType":"auto","position":22.0,"command":"fnldata.rdd.cartesian(fnldata.rdd).map(lambda (x, y):(x[0], y[0], float(cosine_similarity(x[1], y[1])[0][0]), jaccard_similarity_score(x[1], y[1]), manhattan_distances(x[0], y[0])[0][0], euclidean_distances(x[0], y[0])[0][0])).take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">21</span><span class=\"ansired\">]: </span>\n[(32281, 32281, 1.0, 1.0, 0.0, 0.0),\n (32281, 5114, 0.1889822365046136, 0.79069767441860461, 27167.0, 27167.0),\n (32281, 28977, 0.0, 0.7441860465116279, 3304.0, 3304.0),\n (32281, 9253, 0.0, 0.86046511627906974, 23028.0, 23028.0),\n (32281, 9969, 0.0, 0.7441860465116279, 22312.0, 22312.0)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519929442988,"submitTime":1519929321808,"finishTime":1519929443669,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d4a743cb-4002-44fd-b0df-20471e94f2ab"},{"version":"CommandV1","origId":1634643082207809,"guid":"b3b9a396-9cdd-4aae-8e61-5dd0f269246c","subtype":"command","commandType":"auto","position":23.0,"command":"recommnd = spark.createDataFrame(fnldata.rdd.cartesian(fnldata.rdd).map(lambda (x, y):(x[0], y[0], float(cosine_similarity(x[1], y[1])[0][0]), float(jaccard_similarity_score(x[1], y[1])), float(manhattan_distances(x[0], y[0])[0][0]), float(euclidean_distances(x[0], y[0])[0][0]))), ['anime_id1', 'anime_id2','cosine_similarity', 'jaccard_similarity', 'manhattan_distances', 'euclidean_distances'])\nprint recommnd.show(25)","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"recommnd","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"anime_id1","nullable":true,"type":"long"},{"metadata":{},"name":"anime_id2","nullable":true,"type":"long"},{"metadata":{},"name":"cosine_similarity","nullable":true,"type":"double"},{"metadata":{},"name":"jaccard_similarity","nullable":true,"type":"double"},{"metadata":{},"name":"manhattan_distances","nullable":true,"type":"double"},{"metadata":{},"name":"euclidean_distances","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1519929321909,"submitTime":1519929321909,"finishTime":1519935339886,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a0095744-80b2-46a6-86bb-323f9e2f0518"},{"version":"CommandV1","origId":1634643082207810,"guid":"bf0d73bd-b0fb-436c-b582-473ac4f8915a","subtype":"command","commandType":"auto","position":24.0,"command":"recommnd.filter(recommnd.anime_id1==28977).show()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1519929322010,"submitTime":1519929322010,"finishTime":1519935339888,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Items that are similar to the sample ","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2bc98aee-ccdf-40a7-ae65-57abc9d34b89"}],"dashboards":[],"guid":"3ac124cd-917b-4728-85ab-53d9233746bc","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/metrics-graphics.js"
 onerror="window.mainJsLoadError = true;"></script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
